<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        td {
            min-width: 20px;
            min-height: 20px;
        }
    </style>
</head>
<body>
<h1>数字迷图</h1>
<h3 id="title"> Begin Your Game! </h3>
<table border="1" id="box"></table>
<script>
    const SIZE = 6;
    let pos = [];
    let pans = [];
    let rows = [];
    let cols = [];
    let i, j;
    let box = document.getElementById("box");
    for (i = 0; i < SIZE; i++) {
        pos[i] = [];
        pans[i] = [];
        for (j = 0; j < SIZE; j++) {
            pos[i][j] = Math.round(Math.random());
            pans[i][j] = 0;
        }
    }

    for (i = 0; i < SIZE; i++) {
        let count = 0;
        let counts = [];
        for (j = 0; j < SIZE; j++) {
            if (count !== 0 && pos[i][j] === 0) {
                counts.push(count);
                count = 0;
            }
            if (pos[i][j] === 1) {
                count += 1;
            }
            if (pos[i][j] === 1 && j === SIZE - 1) {
                counts.push(count);
            }
            if (counts.length === 0 && j === SIZE - 1) {
                counts.push(0);
            }
        }
        rows.push(counts);
    }

    for (j = 0; j < SIZE; j++) {
        let count = 0;
        let counts = [];
        for (i = 0; i < SIZE; i++) {
            if (count !== 0 && pos[i][j] === 0) {
                counts.push(count);
                count = 0;
            }
            if (pos[i][j] === 1) {
                count += 1;
            }
            if (pos[i][j] === 1 && i === SIZE - 1) {
                counts.push(count);
            }
            if (counts.length === 0 && i === SIZE - 1) {
                counts.push(0);
            }
        }
        cols.push(counts);
    }

    let tr = document.createElement("tr");
    let td1 = document.createElement("td");
    tr.append(td1);
    for (i = 0; i < cols.length; i++) {
        let td = document.createElement("td");
        let html = "";
        cols[i].map(item => {
            html += item;
            html += "<br />";
        });
        td.innerHTML = html;
        tr.append(td);
    }
    box.append(tr);

    for (i = 0; i < SIZE; i++) {
        let tr = document.createElement("tr");
        let td1 = document.createElement("td");
        let html = "";
        rows[i].map(item => {
            html += item;
            html += " ";
        });
        td1.innerHTML = html;
        tr.append(td1);
        for (j = 0; j < SIZE; j++) {
            let td = document.createElement("td");
            td.style.background = "#000000";
            let posx = i;
            let posy = j;
            td.onclick = function () {
                let str = posx + "-" + posy;
                document.getElementById("title").innerText = "Game Start! You Just Pressed " + str + " is it RIGHT?";
                let it = document.getElementById(str);
                if (pans[posx][posy] === 0) {
                    it.style.background = "#ffffff";
                    pans[posx][posy] = 1;
                } else {
                    it.style.background = "#000000";
                    pans[posx][posy] = 0;
                }
                check();
            };
            td.id = i + "-" + j;
            tr.append(td);
        }
        box.append(tr);
    }

    function check() {
        flag = true;
        for (i = 0; i < SIZE; i++) {
            for (j = 0; j < SIZE; j++) {
                if (pos[i][j] !== pans[i][j]) {
                    flag = false;
                }
            }
        }
        if (flag) {
            document.getElementById("title").innerText = "YOU WIN!"
        }
    }
</script>
</body>
</html>